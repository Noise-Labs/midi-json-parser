// tslint:disable-next-line:max-line-length
export const worker = `!function(){"use strict";var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength-(t-e.byteOffset);t+=e.byteOffset;for(var r=[],i=new Uint8Array(e.buffer,t,n),o=0;o<n;o+=1){var a=i[o].toString(16).toUpperCase();1===a.length&&(a=0+a),r[o]=a}return r.join("")},t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength-(t-e.byteOffset);t+=e.byteOffset;var r=new Uint8Array(e.buffer,t,n);return String.fromCharCode.apply(null,r)},n=function(e){for(var t=new DataView(e),n=i(t),r=14,o=[],a=0,f=n.numberOfTracks;a<f;a+=1){var g=void 0,u=s(t,r);r=u.offset,g=u.track,o.push(g)}return{division:n.division,format:n.format,tracks:o}},r=function(e,t,n){var r=void 0,i=void 0,s=g(e,t);t=s.offset,r=s.value;var u=e.getUint8(t);return i=240===u?f(e,t+1):255===u?o(e,t+1):a(u,e,t+1,n),i.event.delta=r,i},i=function(e){if("MThd"!==t(e,0,4))throw new Error('Unexpected characters "'+t(e,0,4)+'" found instead of "MThd"');if(6!==e.getUint32(4))throw new Error("The header has an unexpected length of "+e.getUint32(4)+" instead of 6");var n=e.getUint16(8),r=e.getUint16(10);return{division:e.getUint16(12),format:n,numberOfTracks:r}},o=function(e,n){var r=void 0,i=void 0,o=e.getUint8(n),a=g(e,n+1);if(n=a.offset,i=a.value,3===o)r={trackName:t(e,n,i)};else if(32===o)r={channelPrefix:e.getUint8(n)};else if(33===o)r={midiPort:e.getUint8(n)};else if(47===o)r={endOfTrack:!0};else if(81===o)r={setTempo:{microsecondsPerBeat:(e.getUint8(n)<<16)+(e.getUint8(n+1)<<8)+e.getUint8(n+2)}};else if(84===o){var f=void 0,s=e.getUint8(n);0==(96&s)?f=24:32==(96&s)?f=25:64==(96&s)?f=29:96==(96&s)&&(f=30),r={smpteOffset:{frame:e.getUint8(n+3),frameRate:f,hour:31&s,minutes:e.getUint8(n+1),seconds:e.getUint8(n+2),subFrame:e.getUint8(n+4)}}}else if(88===o)r={timeSignature:{denominator:Math.pow(2,e.getUint8(n+1)),metronome:e.getUint8(n+2),numerator:e.getUint8(n),thirtyseconds:e.getUint8(n+3)}};else{if(89!==o)throw new Error('Cannot parse a meta event with a type of "'+o.toString(16)+'"');r={keySignature:{key:e.getInt8(n),scale:e.getInt8(n+1)}}}return{event:r,offset:n+i}},a=function(e,t,n,r){var i=void 0,o=e>>4;if(0==(128&e)?n-=1:r=null,8===o||null!==r&&"noteOff"in r)i={noteOff:{noteNumber:t.getUint8(n),velocity:t.getUint8(n+1)}},n+=2;else if(9===o||null!==r&&"noteOn"in r){var a=t.getUint8(n),f=t.getUint8(n+1);i=0===f?{noteOff:{noteNumber:a,velocity:f}}:{noteOn:{noteNumber:a,velocity:f}},n+=2}else if(11===o||null!==r&&"controlChange"in r)i={controlChange:{type:t.getUint8(n),value:t.getUint8(n+1)}},n+=2;else if(12===o||null!==r&&"programChange"in r)i={programChange:{programNumber:t.getUint8(n)}},n+=1;else{if(!(14===o||null!==r&&"pitchBend"in r))throw new Error('Cannot parse a midi event with a type of "'+o.toString(16)+'"');i={pitchBend:t.getUint8(n)|t.getUint8(n+1)<<7},n+=2}return i.channel=15&e,{event:i,offset:n}},f=function(t,n){var r=void 0,i=g(t,n);return n=i.offset,r=i.value,{event:{sysex:e(t,n,r)},offset:n+r}},s=function(e,n){if("MTrk"!==t(e,n,4))throw new Error('Unexpected characters "'+t(e,n,4)+'" found instead of "MTrk"');var i=null,o=[],a=e.getUint32(n+4)+n+8;for(n+=8;n<a;){var f=r(e,n,i);i=f.event,n=f.offset,o.push(i)}return{offset:n,track:o}},g=function(e,t){for(var n=0;;){var r=e.getUint8(t);if(t+=1,!(r>127))return n+=r,{offset:t,value:n};n+=127&r,n<<=7}};addEventListener("message",function(e){var t=e.data;try{if("parse"!==t.method)throw new Error('The given method "'+t.method+'" is not supported');var r=t.id,i=t.params.arrayBuffer,o=n(i);postMessage({error:null,id:r,result:{midiFile:o}})}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}})}();`;
